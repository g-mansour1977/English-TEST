<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Test de positionnement ‚Äî Anglais (Terminale)</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f9;
  margin:0;
  font-size:18px;
}
header{
  background:#0ea5a4;
  color:white;
  padding:20px;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
.card{
  background:white;
  padding:20px;
  border-radius:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.1);
}
.q{
  margin-bottom:18px;
  padding:12px;
  background:#f9fafb;
  border-radius:6px;
}
label{display:block;margin:6px 0}
button{
  padding:12px 18px;
  font-size:16px;
  background:#0ea5a4;
  color:white;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
textarea{
  width:100%;
  min-height:120px;
  font-size:16px;
}
#result{
  margin-top:20px;
  padding:15px;
  background:#e7f9f7;
  border-radius:8px;
}
</style>
</head>

<body>

<button onclick="exportPDF()" style="margin:15px">Exporter en PDF</button>

<header>
  <h1>Test de positionnement en Anglais ‚Äì Niveau Terminale</h1>
</header>

<div class="container">
<div class="card">
<form id="testForm">

  <h2>Informations du candidat</h2>

<div class="q">
  <label>Nom et pr√©nom</label>
  <input type="text" id="nom" name="nom" required>
</div>

<div class="q">
  <label>T√©l√©phone</label>
  <input type="tel" id="tel" name="tel" placeholder="+221..." required>
</div>

<div class="q">
  <label>Email</label>
  <input type="email" id="email" name="email">
</div>


<!-- PARTIE 1 -->
<h2>PARTIE 1 ‚Äì Grammaire avanc√©e (15 pts)</h2>

<div class="q">
<label>1. She ___ here since 2018.</label>
<label><input type="radio" name="q1" value="a"> has lived</label>
<label><input type="radio" name="q1" value="b"> is living</label>
<label><input type="radio" name="q1" value="c"> lives</label>
</div>

<div class="q">
<label>2. If I ___ more time, I would travel.</label>
<label><input type="radio" name="q2" value="a"> have</label>
<label><input type="radio" name="q2" value="b"> had</label>
<label><input type="radio" name="q2" value="c"> will have</label>
</div>

<div class="q">
<label>3. Passive voice :</label>
<p><em>They built the bridge in 2010.</em></p>
<label><input type="radio" name="q3" value="a"> was built</label>
<label><input type="radio" name="q3" value="b"> is built</label>
<label><input type="radio" name="q3" value="c"> has built</label>
</div>

<!-- PARTIE 2 -->
<h2>PARTIE 2 ‚Äì Vocabulaire & expressions (10 pts)</h2>

<div class="q">
<label>4. ‚ÄúGive up‚Äù signifie :</label>
<label><input type="radio" name="q4" value="a"> abandonner</label>
<label><input type="radio" name="q4" value="b"> continuer</label>
<label><input type="radio" name="q4" value="c"> d√©cider</label>
</div>

<div class="q">
<label>5. Expression correcte :</label>
<label><input type="radio" name="q5" value="a"> make a decision</label>
<label><input type="radio" name="q5" value="b"> do a decision</label>
<label><input type="radio" name="q5" value="c"> take a decide</label>
</div>

<!-- PARTIE 3 -->
<h2>PARTIE 3 ‚Äì Compr√©hension √©crite (10 pts)</h2>

<p>
Many students believe that learning English is essential today.
It helps them find jobs, study abroad and communicate worldwide.
</p>

<div class="q">
<label>6. Why is English important?</label>
<label><input type="radio" name="q6" value="a"> Only for exams</label>
<label><input type="radio" name="q6" value="b"> For opportunities and communication</label>
<label><input type="radio" name="q6" value="c"> Only for travel</label>
</div>

<!-- PARTIE 4 -->
<h2>PARTIE 4 ‚Äì Expression √©crite (5 pts)</h2>
<p>Write 5‚Äì6 lines: <strong>Why is learning English important for your future?</strong></p>
<textarea id="q7"></textarea>

<button type="button" onclick="corriger()">Corriger</button>

<div id="result" hidden></div>

</form>
</div>
</div>

<!-- JS -->
<script>

const SHEET_URL = "https://script.google.com/macros/s/AKfycbygu4uzVSM9j4BXIh_58uAPEQi4Ay5_N10An4yWtCNvo7Zihuzavocj2Od6rH2jzjAMHw/exec";

const answers = {
  q1:'a', q2:'b', q3:'a', q4:'a', q5:'a', q6:'b'
};

function corriger(){

  // üîπ R√©cup√©ration infos candidat
  const nom = document.getElementById("nom").value.trim();
  const tel = document.getElementById("tel").value.trim();
  const email = document.getElementById("email").value.trim();

  if(!nom || !tel){
    alert("Veuillez renseigner le nom et le t√©l√©phone");
    return;
  }

  let score = 0;
  const data = {};

  // üîπ QCM
  for(let q in answers){
    const el = document.querySelector(`input[name="${q}"]:checked`);
    data[q] = el ? el.value : "";
    if(el && el.value === answers[q]) score += 5;
  }

  // üîπ Expression √©crite
  data.q7 = document.getElementById("q7").value;

  const text = data.q7.toLowerCase();
  if(text.includes("english")) score++;
  if(text.includes("future") || text.includes("job") || text.includes("study")) score++;

  // üîπ Niveau
  let level = "";
  if(score < 15) level = "Coll√®ge";
  else if(score < 25) level = "Seconde / Premi√®re";
  else if(score < 35) level = "Terminale";
  else level = "Terminale + / Post-bac";

  // üîπ Affichage
  const r = document.getElementById("result");
  r.hidden = false;
  r.innerHTML = `
    <h3>R√©sultat</h3>
    <p>Score : <strong>${score}/40</strong></p>
    <p>Niveau estim√© : <strong>${level}</strong></p>
  `;

  // üîπ Envoi vers Google Sheets
  fetch(SHEET_URL, {
    method: "POST",
    body: JSON.stringify({
      nom,
      tel,
      email,
      score,
      level,
      ...data
    })
  })
  .then(()=>console.log("Donn√©es envoy√©es"))
  .catch(err=>console.error("Erreur Sheets", err));
}
</script>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
async function exportPDF(){
  const {jsPDF}=window.jspdf;
  const canvas=await html2canvas(document.body,{scale:3});
  const img=canvas.toDataURL("image/png");
  const pdf=new jsPDF("p","mm","a4");
  pdf.addImage(img,"PNG",5,5,200,0);
  pdf.save("test-anglais-terminale.pdf");
}
</script>

</body>
</html>
